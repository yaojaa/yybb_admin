webpackJsonp([12],{"9uXG":function(e,t){},Vg9s:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=a("fZjL"),l=a.n(o),r={name:"tabletest",data:function(){return{dialogVisible:!1,videoUploadPercent:"0%",videoFlag:!1,breadcrumb:[{name:"平台管理"},{name:"消息推送",url:"/admin/news/list"},{name:"添加消息"}],ruleForm:{title:"",pic:[],content:"",type:1,video:"",video_pic:"",pos_on:1,business_on:1,link_type:1},rules:{title:[{required:!0,message:"请输入活动标题",trigger:"blur"}],content:[{required:!0,message:"请输入活动规则",trigger:"blur"}]}}},methods:{beforeAvatarUpload:function(e){var t="image/jpeg"===e.type||"image/png"===e.type,a=e.size/1024/1024<5;return t||this.$message.error("上传头像图片只能是 JPG 或 PNG 格式!"),a||this.$message.error("上传头像图片大小不能超过 5MB!"),t&&a},handleUploadSuccess_data_contrast:function(e){this.ruleForm.video=e.data.url},beforeUploadVideo:function(e){if(!(e.size/1024/1024<12))return this.$message.error("上传视频大小不能超过12MB哦!"),!1},uploadVideoProcess:function(e,t,a){this.videoFlag=!0,this.videoUploadPercent=parseInt(t.percentage),console.log(this.videoUploadPercent)},handleVideoSuccess:function(e,t){this.videoFlag=!1,this.videoUploadPercent=0,console.log(e),this.ruleForm.video=e.data.url},uploadActivityImg:function(e){this.ruleForm.pic.push(e.data.url)},uploadVideoImg:function(e){this.ruleForm.video_pic=e.data.url},handleRemove:function(e,t){this.ruleForm.pic.splice(e.url,1),console.log(this.ruleForm.pic,"pic")},cancal:function(){},radioChange:function(e){this.ruleForm.pos_on=e},submit:function(){var e=this,t=this.$route.params;this.ruleForm.id=t.id,l()(t).length?this.$axios.post("/api/admin/news/modify",this.ruleForm).then(function(t){0==t.data.code?(e.$alert("操作成功"),e.$router.push("/admin/news/list")):e.$alert(t.data.msg)}).catch(function(t){e.$alert("操作失败"+t)}):this.$axios.post("/api/admin/news/create",this.ruleForm).then(function(t){0==t.data.code?(e.$alert("操作成功"),e.$router.push("/admin/news/list")):e.$alert(t.data.msg)}).catch(function(t){e.$alert("操作失败"+t)})}},mounted:function(){},components:{BreadCrumb:a("tVcc").a},created:function(){var e=this;console.log(this.$route.params,"this.$route.params");var t=this.$route.params;l()(t).length&&(this.dialogVisible=!0,this.$axios.post("/api/admin/news/detail",t).then(function(t){console.log(t.data.data,"data----data"),e.ruleForm=t.data.data}))},computed:{}},i={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page"},[a("div",{staticClass:"page-header"},[a("div",{staticClass:"crumbs"},[a("bread-crumb",{attrs:{"bread-crumb":e.breadcrumb}})],1)]),e._v(" "),a("div",{staticClass:"page-content"},[a("div",{staticClass:"panel invite-box"},[a("div",{staticClass:"form-panel p-xl  width620"},[a("el-form",{ref:"ruleForm1",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"140px"}},[a("el-form-item",{attrs:{label:"管理端是否接收："}},[a("el-radio-group",{on:{change:e.radioChange},model:{value:e.ruleForm.business_on,callback:function(t){e.$set(e.ruleForm,"business_on",t)},expression:"ruleForm.business_on"}},[a("el-radio",{attrs:{label:1}},[e._v("是")]),e._v(" "),a("el-radio",{attrs:{label:0}},[e._v("否")])],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"POS端是否接收："}},[a("el-radio-group",{model:{value:e.ruleForm.pos_on,callback:function(t){e.$set(e.ruleForm,"pos_on",t)},expression:"ruleForm.pos_on"}},[a("el-radio",{attrs:{label:1}},[e._v("是")]),e._v(" "),a("el-radio",{attrs:{label:0}},[e._v("否")])],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"通知类型："}},[a("el-radio-group",{model:{value:e.ruleForm.type,callback:function(t){e.$set(e.ruleForm,"type",t)},expression:"ruleForm.type"}},[a("el-radio",{attrs:{label:1}},[e._v("重要通知")]),e._v(" "),a("el-radio",{attrs:{label:2}},[e._v("新品")]),e._v(" "),a("el-radio",{attrs:{label:3}},[e._v("优惠活动通知")]),e._v(" "),a("el-radio",{attrs:{label:4}},[e._v("公告")]),e._v(" "),a("el-radio",{attrs:{label:5}},[e._v("动态")])],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"标题：",prop:"title"}},[a("el-input",{model:{value:e.ruleForm.title,callback:function(t){e.$set(e.ruleForm,"title",t)},expression:"ruleForm.title"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"视频："}},[a("el-upload",{attrs:{accept:"video/mp4,image/*",action:"/api/admin/fileupload/image","show-file-list":!1,"before-upload":e.beforeUploadVideo,"on-success":e.handleVideoSuccess,"on-progress":e.uploadVideoProcess}},[e.ruleForm.video?[""!=e.ruleForm.video&&0==e.videoFlag?a("video",{attrs:{src:e.ruleForm.video,width:"350",height:"180",controls:"controls"}},[e._v("您的浏览器不支持视频播放")]):e._e()]:e._e(),e._v(" "),1==e.videoFlag?a("el-progress",{staticStyle:{"margin-top":"30px"},attrs:{type:"circle",percentage:e.videoUploadPercent}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon",staticStyle:{"font-size":"48px","margin-top":"15%"}})],2)],1),e._v(" "),a("el-form-item",{attrs:{label:"视频封面："}},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:"/api/admin/fileupload/image","show-file-list":!1,"before-upload":e.beforeAvatarUpload,"on-success":e.uploadVideoImg}},[e.ruleForm.video_pic?a("img",{attrs:{width:"360px",height:"180px",src:e.ruleForm.video_pic}}):a("div",{staticStyle:{"padding-top":"10%"}},[a("i",{staticClass:"el-icon-plus",staticStyle:{"font-size":"48px"}}),e._v(" "),a("p",[e._v("上传视频封面")])])])],1),e._v(" "),a("el-form-item",{attrs:{label:"图片："}},[a("el-upload",{attrs:{action:"/api/admin/fileupload/image","list-type":"picture-card","on-success":e.uploadActivityImg,"on-remove":e.handleRemove}},[a("i",{staticClass:"el-icon-plus upload-placeholder"})]),e._v(" "),e.dialogVisible?e._l(e.ruleForm.pic,function(t){return a("img",{key:t,staticClass:"remove-img",attrs:{src:t,alt:"",width:"146px",height:"146px"},on:{click:e.handleRemove}})}):e._e(),e._v(" "),a("div",{staticClass:"upload-title"},[a("p",{staticClass:"upload-title-red"},[e._v("支持上传多张图片，支持JPEG、PNG 等大部分图片格式")])])],2),e._v(" "),a("el-form-item",{attrs:{label:"活动规则：",prop:"content"}},[a("el-input",{attrs:{type:"textarea",rows:5},model:{value:e.ruleForm.content,callback:function(t){e.$set(e.ruleForm,"content",t)},expression:"ruleForm.content"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"是否查看详情页："}},[a("el-radio-group",{model:{value:e.ruleForm.link_type,callback:function(t){e.$set(e.ruleForm,"link_type",t)},expression:"ruleForm.link_type"}},[a("el-radio",{attrs:{label:1}},[e._v("可查看")]),e._v(" "),a("el-radio",{attrs:{label:0}},[e._v("否")])],1)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{size:"large",type:"primary"},on:{click:e.cancal}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{size:"large",type:"primary"},on:{click:e.submit}},[e._v("确定")])],1)],1)],1)])])])},staticRenderFns:[]};var s=a("VU/8")(r,i,!1,function(e){a("9uXG")},"data-v-3b131871",null);t.default=s.exports}});