webpackJsonp([92],{"7M+B":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("Xxa5"),s=a.n(r),o=a("exGp"),n=a.n(o),i=(a("NYxO"),{name:"tabletest",components:{BreadCrumb:a("tVcc").a},data:function(){return{shareGetInfo:{},breadcrumb:[{name:"商品管理"},{name:"分享海报"}],card:{type_name:"分享卡片",img_url:""}}},computed:{goodId:function(){return Number(this.$route.query.good_id)}},created:function(){var e=this;return n()(s.a.mark(function t(){var a;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return console.log(e.goodId,"goodId"),t.next=3,e.$store.dispatch("share/fetchGetCard",{id:e.goodId});case 3:a=t.sent,e.card.img_url=a,e.getShareSet();case 6:case"end":return t.stop()}},t,e)}))()},methods:{$_change:function(e,t,a){"success"===e.status&&(a.img_url=URL.createObjectURL(e.raw),this.$store.dispatch("share/fetchCreateCard",{id:this.goodId,type_name:a.type_name,img_url:t[0].response.data.url}))},shareSure:function(){var e=this,t={id:this.goodId,share_model_content:this.shareGetInfo.share_model_content,share_model_title:this.shareGetInfo.share_model_title};this.$axios.post("/api/admin/shopgoods/createShareSet",t).then(function(t){0==t.data.code?(e.$alert("提交成功"),e.$router.go(-1)):e.$alert("操作失败"+t.data.msg)}).catch(function(t){e.$alert("操作失败"+t)})},getShareSet:function(){var e=this,t={id:this.goodId};console.log(t,"params"),this.$axios.post("/api/admin/shopgoods/getShareSet",t).then(function(t){0==t.data.code?(e.shareGetInfo=t.data.data,console.log(e.shareGetInfo,"share")):e.$alert("操作失败"+t.data.msg)}).catch(function(t){e.$alert("操作失败"+t)})},$_beforeUpload:function(e){var t="image/jpeg"===e.type||"image/png"===e.type,a=e.size/1024/1024<5;return t||this.$message.error("上传头像图片只能是 JPG 或 PNG 格式!"),a||this.$message.error("上传头像图片大小不能超过 5MB!"),t&&a},$_clearFiles:function(e){e.imageUrl="",e.img_url="",this.$store.dispatch("share/fetchCreateCard",{id:this.goodId,type_name:e.type_name,img_url:""})}}}),l={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page",attrs:{id:"createGood"}},[a("div",{staticClass:"page-header"},[a("div",{staticClass:"crumbs"},[a("bread-crumb",{attrs:{"bread-crumb":e.breadcrumb}})],1)]),e._v(" "),a("div",{staticClass:"page-content"},[a("el-form",{staticClass:"small-form share-form",attrs:{"label-width":"100px"}},[a("el-form-item",{attrs:{label:"分享海报文字:"}},[a("el-input",{model:{value:e.shareGetInfo.share_model_content,callback:function(t){e.$set(e.shareGetInfo,"share_model_content",t)},expression:"shareGetInfo.share_model_content"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"分享海报标题:"}},[a("el-input",{model:{value:e.shareGetInfo.share_model_title,callback:function(t){e.$set(e.shareGetInfo,"share_model_title",t)},expression:"shareGetInfo.share_model_title"}})],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:8}},[a("el-button",{attrs:{type:"change"}},[e._v(e._s(e.card.type_name))]),e._v(" "),a("el-upload",{staticClass:"avatar-uploader",attrs:{action:"/api/admin/fileupload/image","show-file-list":!1,"on-change":function(t,a){return e.$_change(t,a,e.card)},"before-upload":e.$_beforeUpload}},[e.card.img_url?a("img",{staticClass:"avatar",attrs:{src:e.card.img_url,width:"360px",height:"180px"}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"}),e._v(" "),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("支持上传1张图片，图片框高逼为3:1，支持JPG,PNG等格式图片，单张图片大小不超过5M")])])],1)],1),e._v(" "),a("el-form",{staticClass:"bottom-form",attrs:{"label-width":"80px"}},[a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.shareSure}},[e._v("确定")])],1)],1)],1)])},staticRenderFns:[]};var c=a("VU/8")(i,l,!1,function(e){a("pjSz")},null,null);t.default=c.exports},pjSz:function(e,t){}});