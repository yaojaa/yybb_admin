webpackJsonp([105],{"2SMf":function(t,e){},Ruln:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=o("bOdI"),i=o.n(a),l=o("gRE1"),n=o.n(l),c=o("fZjL"),s=o.n(c),r=o("0qDT"),u=o("PMOO"),p=o("tVcc"),d={data:function(){return{breadcrumb:[{name:"营销管理",url:"/marketing/markList"},{name:"满减/立减优惠券",url:"/marketing/fullReducionCouponList"}],user:JSON.parse(localStorage.user),dialogCode:!1,coupon_code:"",coupon_title:"",coupon_status:null,dialog:!1,exchange_coupon_title:"",codeStartTime:"",codeEndTime:"",codeTotalNumber:"",codeUserLimit:"",business_id:"",is_use:"",remark:"无",currentItem:{},status_filter:"",tagsListGroup:{"优惠券类型:":[{title:"全部",key:"coupon_rule_type",value:0},{title:"满减",key:"coupon_rule_type",value:1},{title:"立减",key:"coupon_rule_type",value:2}],"活动专属:":[{title:"全部",key:"coupon_in_shop",value:0},{title:"是",key:"coupon_in_shop",value:2},{title:"否",key:"coupon_in_shop",value:1}]},searchs:{list:[{type:"input-text",label:"优惠券ID",name:"coupon_code",value:"",placeholder:""}]},url:"/api/admin/coupon/index?coupon_rule_type=0",tableJson:{column:[{type:"text",align:"center",label:"优惠券ID",prop:"coupon_code",width:"120px"},{type:"text",align:"center",label:"创建时间",prop:"coupon_ctime",width:"200"},{type:"text",align:"center",label:"类型",prop:"coupon_rule_type",width:"60px",formatter:function(t){return 1==t.coupon_rule_type?"<p style='text-align: center'>满减</p>":"<p style='text-align: center'>立减</p>"}},{type:"text",align:"center",label:"标题",prop:"coupon_title",width:"200px"},{type:"text",align:"center",label:"满减(元)",prop:"shop_name",width:"150px",formatter:function(t){if(t.rules)return"<p style='text-align: center'>\n                                满"+t.rules.price/100+"</br>\n                                减"+t.rules.reduce_price/100+"</p>"}},{type:"text",align:"center",label:"创建人",prop:"admin_user_name",width:"120px"},{type:"text",label:"状态",align:"center",width:"",prop:"coupon_status",formatter:function(t){return 1==t.coupon_status?"<p style='text-align: center'>未开始</p>":"<p style='text-align: center'>进行中</p>"}},{type:"switch_button",label:"上架/下架",align:"center",width:"100",prop:"coupon_status",value:["上架","下架"]},{type:"handle",label:"操作",align:"center",width:"",list:[{label:"生成兑换券",type:"edit",onClick:function(t,e,o){e.creatCode(o)}},{label:"已用门店",type:"edit",onClick:function(t,e,o){e.$router.push("/marketing/usedShop/"+o.coupon_code)}},{label:"编辑",type:"edit",onClick:function(t,e,o){e.$router.push("/marketing/addCoupon/"+o.coupon_code)}},{label:"详情",type:"detail",onClick:function(t,e,o){e.$router.push("/marketing/couponInfo/"+o.coupon_code)}}]}]}}},components:{NomalTable:r.a,TableSearch:u.a,BreadCrumb:p.a},beforeRouteUpdate:function(t,e,o){console.log(t.query),this.status_filter=s()(t.query)[0]+n()(t.query)[0],this.$refs.table.getData(t.query),o()},created:function(){},computed:{},methods:{upperShelf:function(){var t=this,e={coupon_code:this.coupon_code};1==this.coupon_status&&this.$axios.post("/api/admin/coupon/close",e).then(function(e){0==e.data.code?(t.$alert("操作成功"),t.dialog=!1,t.$refs.table.getData({is_page:1,page:1})):t.$alert(e.data.msg)}).catch(function(e){t.$alert("操作失败"+e)}),2==this.coupon_status&&this.$axios.post("/api/admin/coupon/publish",e).then(function(e){0==e.data.code?(t.$alert("操作成功"),t.dialog=!1,t.$refs.table.getData({is_page:1,page:1})):t.$alert(e.data.msg)}).catch(function(e){t.$alert("操作失败"+e)})},dialogCodeClose:function(){this.dialogCode=!1},dialogCodeSure:function(){var t=this,e={coupon_code:this.coupon_code,exchange_coupon_title:this.exchange_coupon_title,exchange_coupon_total:this.codeTotalNumber,exchange_coupon_user_limit:this.codeUserLimit,exchange_coupon_start_time:this.codeStartTime,exchange_coupon_end_time:this.codeEndTime};this.$axios.post("/api/admin/couponExchange/add",e).then(function(e){0==e.data.code?(t.$alert("操作成功"),t.dialogCode=!1):t.$alert(e.data.msg)}).catch(function(e){t.$alert("操作失败"+e)})},creatCode:function(t){this.dialogCode=!0,this.coupon_code=t.coupon_code,this.coupon_status=t.coupon_status,console.log(t,"params-------")},listenSwitchChange:function(t){var e=t.value,o=e.coupon_title,a=e.coupon_status,i=e.coupon_code;this.coupon_status=2==a?1:2,this.coupon_title=o,this.coupon_code=i,console.log(this.coupon_status,"freeze"),console.log(this.coupon_title,"coupon_title"),this.dialog=!0},getData:function(t,e){this.$refs.table.getData(i()({},t,e))},formatPrice1:function(t){return t/100}}},_={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"page"},[o("div",{staticClass:"page-header"},[o("div",{staticClass:"crumbs"},[o("bread-crumb",{attrs:{"bread-crumb":t.breadcrumb}})],1),t._v(" "),o("div",{staticClass:"page-header-actions"},[o("el-button",{attrs:{icon:"el-icon-plus",size:"mini",type:"primary"},on:{click:function(e){t.$router.push({path:"/marketing/addCoupon"})}}},[t._v("添加")])],1)]),t._v(" "),o("div",{staticClass:"page-content"},[o("div",{staticClass:"filter-tag-box"},t._l(t.tagsListGroup,function(e,a,i){return o("div",{key:i,staticClass:"filter-tag-item"},[o("div",{staticClass:"tag-hd"},[t._v(t._s(a))]),t._v(" "),o("div",{staticClass:"tag-bd"},t._l(e,function(e,a){return o("router-link",{key:e.value,staticClass:"tag",class:e.key+e.value==t.status_filter?"active":"",attrs:{to:{path:"/marketing/fullReducionCouponList",query:(i={},i[e.key]=e.value,i)}}},[t._v("\n                        "+t._s(e.title))]);var i}))])})),t._v(" "),o("nomal-table",{ref:"table",attrs:{"table-json":t.tableJson,url:t.url},on:{listenSwitchChange:t.listenSwitchChange}},[o("table-search",{attrs:{searchs:t.searchs}})],1),t._v(" "),o("el-dialog",{attrs:{title:"兑换码生成",visible:t.dialogCode,width:"40%",center:""},on:{"update:visible":function(e){t.dialogCode=e}}},[o("el-form",[o("el-form-item",{attrs:{label:"标题:","label-width":"140px"}},[o("el-input",{staticStyle:{width:"220px"},attrs:{autocomplete:"off"},model:{value:t.exchange_coupon_title,callback:function(e){t.exchange_coupon_title=e},expression:"exchange_coupon_title"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"开始时间:","label-width":"140px"}},[o("el-date-picker",{attrs:{type:"date",placeholder:"选择日期"},model:{value:t.codeStartTime,callback:function(e){t.codeStartTime=e},expression:"codeStartTime"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"结束时间:","label-width":"140px"}},[o("el-date-picker",{attrs:{type:"date",placeholder:"选择日期"},model:{value:t.codeEndTime,callback:function(e){t.codeEndTime=e},expression:"codeEndTime"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"兑换数量:","label-width":"140px"}},[o("el-input",{staticStyle:{width:"220px"},attrs:{placeholder:"请输入数字"},model:{value:t.codeTotalNumber,callback:function(e){t.codeTotalNumber=e},expression:"codeTotalNumber"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"每人兑换数量限制:","label-width":"140px"}},[o("el-input",{staticStyle:{width:"220px"},attrs:{placeholder:"请输入数字"},model:{value:t.codeUserLimit,callback:function(e){t.codeUserLimit=e},expression:"codeUserLimit"}}),o("span",[t._v(" 次")])],1)],1),t._v(" "),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:t.dialogCodeClose}},[t._v("取 消")]),t._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:t.dialogCodeSure}},[t._v("确 定")])],1)],1),t._v(" "),o("el-dialog",{attrs:{title:2==t.coupon_status?"上架":"下架",visible:t.dialog,width:"30%"},on:{"update:visible":function(e){t.dialog=e}}},[o("p",{staticStyle:{color:"red"}},[t._v("此操作会"+t._s(2==t.coupon_status?"上架":"下架")+t._s(t.coupon_title)+"优惠券")]),t._v(" "),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(e){t.dialog=!1}}},[t._v("取 消")]),t._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:t.upperShelf}},[t._v("确 定")])],1)])],1)])},staticRenderFns:[]};var h=o("VU/8")(d,_,!1,function(t){o("2SMf")},"data-v-538bdf6d",null);e.default=h.exports}});